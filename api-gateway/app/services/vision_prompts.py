"""
Shared Gemini Vision prompts for metric extraction.

This module contains the improved vision prompt used by both:
- VisionMetricExtractor (legacy service)
- MetricExtractionService (current service)
"""

# Improved Gemini Vision prompt with explicit examples
# Extracts both labels and values, handles pair oppositions
IMPROVED_VISION_PROMPT = """Ты — эксперт по анализу визуальных данных.

Перед тобой изображение БАРЧАРТА или ТАБЛИЦЫ с психометрическими метриками.
Изображение может содержать несколько таблиц/барчартов, объединенных вертикально.

ТВОЯ ЗАДАЧА:
Извлечь пары (название метрики, числовое значение) из изображения.

ФОРМАТ ДАННЫХ НА ИЗОБРАЖЕНИИ:
Обычно это таблица или барчарт вида:
┌──────────────────────────────────┬────────┐
│ НАЗВАНИЕ МЕТРИКИ                 │ЗНАЧЕНИЕ│
├──────────────────────────────────┼────────┤
│ РАБОТА С ДОКУМЕНТАМИ             │  6.4   │
│ ПРОДВИЖЕНИЕ                      │  7.6   │
│ АНАЛИЗ И ПЛАНИРОВАНИЕ            │  4.4   │
└──────────────────────────────────┴────────┘

ПРАВИЛА ИЗВЛЕЧЕНИЯ НАЗВАНИЙ:
✅ ИЗВЛЕКАЙ:
  - Полные названия метрик на РУССКОМ языке
  - Названия в ВЕРХНЕМ РЕГИСТРЕ (если присутствуют)
  - Названия с пробелами (например: "РАБОТА С ДОКУМЕНТАМИ")
  - Названия ролей (ГЕНЕРАТОР ИДЕЙ, КООРДИНАТОР)
  - Названия характеристик (ЛИДЕРСТВО, СТРЕССОУСТОЙЧИВОСТЬ)
  - **ОБЕ СТОРОНЫ ПАР ПРОТИВОПОЛОЖНОСТЕЙ** (см. раздел ниже)

❌ НЕ ИЗВЛЕКАЙ:
  - Служебные слова: "НИЗКАЯ", "ВЫСОКАЯ", "ЗОНЫ ИНТЕРПРЕТАЦИИ"
  - Подписи осей: числа 1, 2, 3, ..., 10 (если они идут подряд)
  - Заголовки разделов/таблиц
  - Легенду графика
  - Символы: ++, +, −, --, %, ±

ОСОБОЕ ВНИМАНИЕ: ПАРЫ ПРОТИВОПОЛОЖНОСТЕЙ
На изображении могут быть метрики, представленные как ПАРЫ ПРОТИВОПОЛОЖНЫХ ХАРАКТЕРИСТИК.
Например:
  - ЗАМКНУТОСТЬ 8.4 ОБЩИТЕЛЬНОСТЬ
  - НЕЗАВИСИМОСТЬ 10 КОНФОРМИЗМ
  - МОРАЛЬНАЯ ГИБКОСТЬ 8.8 МОРАЛЬНОСТЬ
  - ИМПУЛЬСИВНОСТЬ 5.8 ОРГАНИЗОВАННОСТЬ

⚠️ КРИТИЧЕСКИ ВАЖНО: Извлекай ОБЕ СТОРОНЫ пары как ОТДЕЛЬНЫЕ метрики!
Если видишь "ЗАМКНУТОСТЬ 8.4 ОБЩИТЕЛЬНОСТЬ", извлеки:
  {"label": "ЗАМКНУТОСТЬ", "value": "8.4"}
  {"label": "ОБЩИТЕЛЬНОСТЬ", "value": "8.4"}  (или другое значение, если указано)

Если значения не указаны явно для обеих сторон, используй одно значение для обеих метрик.

ПРАВИЛА ИЗВЛЕЧЕНИЯ ЗНАЧЕНИЙ:
✅ ИЗВЛЕКАЙ:
  - ТОЛЬКО числовые значения метрик (НЕ подписи осей!)
  - Диапазон: от 1 до 10 (включительно)
  - Формат: целое число (6, 7, 10) или с одним десятичным (6.4, 7.6, 9.2)
  - Используй точку как разделитель: "6.4" (не запятую)

❌ НЕ ИЗВЛЕКАЙ:
  - Подписи осей X (1, 2, 3, ..., 10), если они идут последовательно
  - Значения вне диапазона 1-10
  - Проценты, символы

ПРИМЕРЫ ОЖИДАЕМОГО ВЫВОДА:

Пример 1 - Барчарт профессиональных областей:
```json
{
  "metrics": [
    {"label": "РАБОТА С ДОКУМЕНТАМИ", "value": "6.4"},
    {"label": "ПРОДВИЖЕНИЕ", "value": "7.6"},
    {"label": "АНАЛИЗ И ПЛАНИРОВАНИЕ", "value": "4.4"},
    {"label": "ПРИНЯТИЕ РЕШЕНИЙ", "value": "1.9"},
    {"label": "РАЗРАБОТКА", "value": "4.7"},
    {"label": "ОБЕСПЕЧЕНИЕ ПРОЦЕССА", "value": "8.4"},
    {"label": "ПОДДЕРЖКА", "value": "9.0"},
    {"label": "КОНТРОЛЬ АУДИТ", "value": "4.5"}
  ]
}
```

Пример 2 - Командные роли:
```json
{
  "metrics": [
    {"label": "ГЕНЕРАТОР ИДЕЙ", "value": "4.5"},
    {"label": "ИССЛЕДОВАТЕЛЬ РЕСУРСОВ", "value": "5.8"},
    {"label": "СПЕЦИАЛИСТ", "value": "5.9"},
    {"label": "АНАЛИТИК", "value": "4.4"},
    {"label": "КООРДИНАТОР", "value": "5.0"},
    {"label": "МОТИВАТОР", "value": "3.0"},
    {"label": "ДУША КОМАНДЫ", "value": "8.9"},
    {"label": "РЕАЛИЗАТОР", "value": "6.2"},
    {"label": "КОНТРОЛЕР", "value": "5.5"}
  ]
}
```

Пример 3 - Интеллект:
```json
{
  "metrics": [
    {"label": "ОБЩИЙ БАЛЛ ИНТЕЛЛЕКТА", "value": "5.5"}
  ]
}
```
ы
Пример 4 - Пара противоположностей (извлекай ОБЕ СТОРОНЫ!):
Если на изображении: "ЗАМКНУТОСТЬ 8.4 ОБЩИТЕЛЬНОСТЬ"
```json
{
  "metrics": [
    {"label": "ЗАМКНУТОСТЬ", "value": "8.4"},
    {"label": "ОБЩИТЕЛЬНОСТЬ", "value": "8.4"}
  ]
}
```

Если на изображении: "НЕЗАВИСИМОСТЬ 10 КОНФОРМИЗМ"
```json
{
  "metrics": [
    {"label": "НЕЗАВИСИМОСТЬ", "value": "10"},
    {"label": "КОНФОРМИЗМ", "value": "10"}
  ]
}
```

Если на изображении: "МОРАЛЬНАЯ ГИБКОСТЬ 8.8 МОРАЛЬНОСТЬ"
```json
{
  "metrics": [
    {"label": "МОРАЛЬНАЯ ГИБКОСТЬ", "value": "8.8"},
    {"label": "МОРАЛЬНОСТЬ", "value": "8.8"}
  ]
}
```

Пример 5 - Если на изображении нет метрик (только заголовок/описание):
```json
{
  "metrics": []
}
```

ВАЖНЫЕ ТРЕБОВАНИЯ:
1. Ответ ТОЛЬКО в JSON формате (без дополнительного текста)
2. Каждая метрика = один объект {"label": "...", "value": "..."}
3. label — ПОЛНОЕ название на русском языке (как написано на изображении)
4. value — строка с числом в формате "X" или "X.Y" (точка как разделитель)
5. Если изображение не содержит метрик, верни: {"metrics": []}
6. **ОБЯЗАТЕЛЬНО извлекай ОБЕ СТОРОНЫ пар противоположностей!** Если видишь пару (например, "ЗАМКНУТОСТЬ 8.4 ОБЩИТЕЛЬНОСТЬ"), создай ДВА отдельных объекта метрик - по одному для каждой стороны пары.

Теперь проанализируй изображение и верни JSON со всеми найденными метриками:
"""
