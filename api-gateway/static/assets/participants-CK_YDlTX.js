import{G as i,W as g,m as u}from"./index-D8-0gMTI.js";const c={async create(e){return(await i.post("/participants",e)).data},async search(e={}){return(await i.get("/participants",{params:e})).data},async getById(e){return(await i.get(`/participants/${e}`)).data},async update(e,t){return(await i.put(`/participants/${e}`,t)).data},async delete(e){return(await i.delete(`/participants/${e}`)).data},async getReports(e){return(await i.get(`/participants/${e}/reports`)).data}},m=g("participants",()=>{const e=u([]),t=u(null),s=u(!1),r=u(null),o=u({total:0,page:1,size:20,totalPages:0});async function d(n={}){s.value=!0,r.value=null;try{const a=await c.search(n);return e.value=a.items,o.value={total:a.total,page:a.page,size:a.size,totalPages:Math.ceil(a.total/a.size)},a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка загрузки участников",a}finally{s.value=!1}}async function v(n){s.value=!0,r.value=null;try{const a=await c.getById(n);return t.value=a,a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка загрузки участника",a}finally{s.value=!1}}async function f(n){s.value=!0,r.value=null;try{const a=await c.create(n);return e.value.unshift(a),a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка создания участника",a}finally{s.value=!1}}async function y(n,a){s.value=!0,r.value=null;try{const l=await c.update(n,a),p=e.value.findIndex(h=>h.id===n);return p!==-1&&(e.value[p]=l),t.value?.id===n&&(t.value=l),l}catch(l){throw r.value=l.response?.data?.detail||"Ошибка обновления участника",l}finally{s.value=!1}}async function w(n){s.value=!0,r.value=null;try{await c.delete(n),e.value=e.value.filter(a=>a.id!==n),t.value?.id===n&&(t.value=null)}catch(a){throw r.value=a.response?.data?.detail||"Ошибка удаления участника",a}finally{s.value=!1}}return{participants:e,currentParticipant:t,loading:s,error:r,pagination:o,searchParticipants:d,getParticipant:v,createParticipant:f,updateParticipant:y,deleteParticipant:w}});export{c as p,m as u};
