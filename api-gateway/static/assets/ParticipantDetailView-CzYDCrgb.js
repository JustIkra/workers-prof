import{G as F,m as v,H as Y,I as Ve,r as c,c as C,o as u,d as a,v as N,J as ze,w as t,u as O,K as Pe,C as je,L as Je,M as h,N as J,z as $e,q as S,f,O as K,a as _,E as b,n as Me,p as He,e as qe,A as Xe,B as ge,t as Ge,P as xe,h as Ke,Q as Qe,R as We,S as Ye,T as Ze,U as et,F as tt}from"./index-DcMoYmP0.js";import{A as at}from"./AppLayout-DdIeRCi4.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{m as we,p as lt}from"./metrics-ESqwtoye.js";import{u as nt,p as ot}from"./participants-YXfxemlR.js";const le={async upload(s,p,n){const y=new FormData;return y.append("report_type",p),y.append("file",n),(await F.post(`/participants/${s}/reports`,y,{headers:{"Content-Type":"multipart/form-data"}})).data},async download(s){return await F.get(`/reports/${s}/download`,{responseType:"blob"})},async getById(s){return(await F.get(`/reports/${s}`)).data},async delete(s){return(await F.delete(`/reports/${s}`)).data},async extract(s){return(await F.post(`/reports/${s}/extract`)).data},async getMetrics(s){return(await F.get(`/reports/${s}/metrics`)).data},async getList(s){return(await F.get(`/participants/${s}/reports`)).data}},ne={async calculate(s,p){return(await F.post(`/scoring/participants/${s}/calculate`,null,{params:{activity_code:p}})).data},async getHistory(s,p=10){return(await F.get(`/scoring/participants/${s}/scores`,{params:{limit:p}})).data},async getById(s){return(await F.get(`/scoring-results/${s}`)).data},async generateRecommendations(s){return(await F.post(`/reports/${s}/recommendations`)).data},async getFinalReport(s,p,n="json"){const y={params:{activity_code:p,format:n}};n==="html"&&(y.responseType="text");const T=await F.get(`/participants/${s}/final-report`,y);return T.data}};function se(s,p=1){if(s==null||s==="")return"";const n=typeof s=="string"?parseFloat(s):s;return isNaN(n)?"":n.toLocaleString("ru-RU",{minimumFractionDigits:p,maximumFractionDigits:p})}function W(s){if(s==null||s==="")return null;const n=String(s).trim().replace(",","."),y=parseFloat(n);return isNaN(y)?null:y}function st(s){return W(s)}function oe(s,p=1){return se(s,p)}const rt={key:0,class:"error-message"},it={__name:"MetricInput",props:{modelValue:{type:[Number,String],default:null},min:{type:Number,default:1},max:{type:Number,default:10},step:{type:Number,default:.1},precision:{type:Number,default:1},placeholder:{type:String,default:"Введите значение"},disabled:{type:Boolean,default:!1},showControls:{type:Boolean,default:!0}},emits:["update:modelValue","change","blur"],setup(s,{emit:p}){const n=s,y=p,T=v(null),M=v(""),U=v(!1),k=v(!1),D=v(""),g=Y(()=>W(M.value)),L=Y(()=>{const r=g.value;return r===null||r<=n.min}),z=Y(()=>{const r=g.value;return r===null||r>=n.max}),I=r=>{if(r==null||r===""){M.value="";return}U.value?M.value=String(r).replace(".",","):M.value=se(r,n.precision)},j=r=>{if(r==null||r==="")return k.value=!1,D.value="",!0;const R=W(r);return R===null?(k.value=!0,D.value="Некорректное число",!1):R<n.min?(k.value=!0,D.value=`Значение должно быть не меньше ${se(n.min,n.precision)}`,!1):R>n.max?(k.value=!0,D.value=`Значение должно быть не больше ${se(n.max,n.precision)}`,!1):(k.value=!1,D.value="",!0)},P=r=>{const R=r.replace(/[^\d,.-]/g,"");let m=!1;const i=R.split("").filter(V=>V===","||V==="."?m?!1:(m=!0,!0):!0).join("").replace(".",",");M.value=i;const d=W(i);d!==null?y("update:modelValue",d):(i===""||i==="-")&&y("update:modelValue",null)},B=()=>{U.value=!1;const r=W(M.value);if(j(M.value)){if(r!==null){const R=Math.round(r*Math.pow(10,n.precision))/Math.pow(10,n.precision),m=Math.max(n.min,Math.min(n.max,R));y("update:modelValue",m),I(m),y("change",m)}}else if(r!==null&&(r<n.min||r>n.max)){const R=Math.max(n.min,Math.min(n.max,r));y("update:modelValue",R),I(R),y("change",R),k.value=!1,D.value=""}y("blur")},H=()=>{U.value=!0,g.value!==null&&(M.value=String(g.value).replace(".",","))},q=()=>{const r=g.value||0,R=Math.min(n.max,r+n.step),m=Math.round(R*Math.pow(10,n.precision))/Math.pow(10,n.precision);y("update:modelValue",m),y("change",m),I(m)},X=()=>{const r=g.value||0,R=Math.max(n.min,r-n.step),m=Math.round(R*Math.pow(10,n.precision))/Math.pow(10,n.precision);y("update:modelValue",m),y("change",m),I(m)};return Ve(()=>n.modelValue,r=>{I(r)},{immediate:!0}),I(n.modelValue),(r,R)=>{const m=c("el-button"),i=c("el-button-group"),d=c("el-input");return u(),C(J,null,[a(d,{ref_key:"inputRef",ref:T,modelValue:M.value,"onUpdate:modelValue":R[0]||(R[0]=V=>M.value=V),placeholder:s.placeholder,disabled:s.disabled,class:Je({"is-invalid":k.value}),onInput:P,onBlur:B,onFocus:H},ze({_:2},[s.showControls?{name:"append",fn:t(()=>[a(i,null,{default:t(()=>[a(m,{icon:O(Pe),disabled:s.disabled||L.value,onClick:X},null,8,["icon","disabled"]),a(m,{icon:O(je),disabled:s.disabled||z.value,onClick:q},null,8,["icon","disabled"])]),_:1})]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"]),k.value?(u(),C("div",rt,h(D.value),1)):N("",!0)],64)}}},ut=be(it,[["__scopeId","data-v-74ef628d"]]),dt={class:"card-header"},ct={key:1},pt={key:0,class:"metric-description"},mt={key:2,class:"metrics-info"},ft={class:"info-row"},_t={key:0,class:"info-row"},vt={__name:"MetricsEditor",props:{reportId:{type:String,required:!0}},emits:["metrics-updated"],setup(s,{emit:p}){const n=s,y=p,T=v(!1),M=v(!1),U=v(!1),k=v(null),D=v([]),g=v([]),L=v({metrics:{}}),z=v({}),I=Y(()=>!g.value||g.value.length===0?[]:[...new Set(g.value.map(i=>i.source))]),j=Y(()=>!g.value||g.value.length===0?null:new Date),P=async()=>{try{const i=await we.listMetricDefs(!0);D.value=i.items||[]}catch(i){console.error("Failed to load metric definitions:",i),k.value="Не удалось загрузить определения метрик"}},B=async()=>{T.value=!0,k.value=null;try{const i=await we.listExtractedMetrics(n.reportId);g.value=i.items||[],L.value.metrics={},g.value.forEach(d=>{L.value.metrics[d.metric_def_id]=W(d.value)}),z.value=JSON.parse(JSON.stringify(L.value.metrics))}catch(i){console.error("Failed to load metrics:",i),k.value="Не удалось загрузить метрики"}finally{T.value=!1}},H=()=>{U.value=!0,z.value=JSON.parse(JSON.stringify(L.value.metrics))},q=()=>{L.value.metrics=JSON.parse(JSON.stringify(z.value)),U.value=!1,k.value=null},X=async()=>{M.value=!0,k.value=null;try{const i=[];for(const[d,V]of Object.entries(L.value.metrics))if(V!=null&&V!==""){const G=st(V);G!==null&&i.push({metric_def_id:d,value:G,source:"MANUAL",notes:null})}if(i.length===0){b.warning("Не введено ни одного значения метрики"),M.value=!1;return}await we.bulkCreateExtractedMetrics(n.reportId,i),b.success(`Успешно сохранено ${i.length} метрик`),U.value=!1,await B(),y("metrics-updated")}catch(i){console.error("Failed to save metrics:",i);let d="Не удалось сохранить метрики";i.response?.data?.detail&&(typeof i.response.data.detail=="string"?d=i.response.data.detail:Array.isArray(i.response.data.detail)&&(d=i.response.data.detail.map(V=>V.msg||V.message).join(", "))),k.value=d,b.error(d)}finally{M.value=!1}},r=i=>{switch(i){case"OCR":return"info";case"LLM":return"warning";case"MANUAL":return"success";default:return""}},R=i=>{switch(i){case"OCR":return"OCR";case"LLM":return"Gemini Vision";case"MANUAL":return"Ручной ввод";default:return i}},m=i=>new Date(i).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return $e(async()=>{await P(),await B()}),Ve(()=>n.reportId,async i=>{i&&await B()}),(i,d)=>{const V=c("el-button"),G=c("el-alert"),re=c("el-form-item"),ie=c("el-col"),Q=c("el-row"),ue=c("el-form"),de=c("el-divider"),ce=c("el-tag"),pe=c("el-card");return u(),S(pe,{class:"metrics-editor"},{header:t(()=>[_("div",dt,[d[4]||(d[4]=_("span",null,"Ручной ввод метрик",-1)),U.value?(u(),C("div",ct,[a(V,{size:"small",onClick:q},{default:t(()=>[...d[2]||(d[2]=[f(" Отмена ",-1)])]),_:1}),a(V,{type:"primary",size:"small",loading:M.value,onClick:X},{default:t(()=>[...d[3]||(d[3]=[f(" Сохранить ",-1)])]),_:1},8,["loading"])])):(u(),S(V,{key:0,type:"primary",size:"small",onClick:H},{default:t(()=>[...d[1]||(d[1]=[f(" Редактировать ",-1)])]),_:1}))])]),default:t(()=>[k.value?(u(),S(G,{key:0,type:"error",title:k.value,closable:"",style:{"margin-bottom":"16px"},onClose:d[0]||(d[0]=$=>k.value=null)},null,8,["title"])):N("",!0),!g.value||g.value.length===0?(u(),S(G,{key:1,type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...d[5]||(d[5]=[f(" Метрики для этого отчёта ещё не извлечены. Вы можете ввести их вручную. ",-1)])]),_:1})):N("",!0),a(ue,{ref:"formRef",model:L.value,"label-position":"top",disabled:!U.value},{default:t(()=>[a(Q,{gutter:20},{default:t(()=>[(u(!0),C(J,null,K(D.value,$=>(u(),S(ie,{key:$.id,xs:24,sm:12,md:8,lg:6},{default:t(()=>[a(re,{label:`${$.name} ${$.unit?"("+$.unit+")":""}`,prop:`metrics.${$.id}`},{default:t(()=>[a(ut,{modelValue:L.value.metrics[$.id],"onUpdate:modelValue":me=>L.value.metrics[$.id]=me,min:$.min_value||1,max:$.max_value||10,precision:1,step:.1,disabled:!U.value,"show-controls":!0,placeholder:"Введите значение (например: 7,5)"},null,8,["modelValue","onUpdate:modelValue","min","max","disabled"]),$.description?(u(),C("div",pt,h($.description),1)):N("",!0)]),_:2},1032,["label","prop"])]),_:2},1024))),128))]),_:1})]),_:1},8,["model","disabled"]),g.value&&g.value.length>0?(u(),C("div",mt,[a(de),_("div",ft,[d[6]||(d[6]=_("span",{class:"info-label"},"Источник данных:",-1)),(u(!0),C(J,null,K(I.value,$=>(u(),S(ce,{key:$,type:r($),size:"small",style:{"margin-left":"8px"}},{default:t(()=>[f(h(R($)),1)]),_:2},1032,["type"]))),128))]),j.value?(u(),C("div",_t,[d[7]||(d[7]=_("span",{class:"info-label"},"Последнее обновление:",-1)),_("span",null,h(m(j.value)),1)])):N("",!0)])):N("",!0)]),_:1})}}},yt=be(vt,[["__scopeId","data-v-bb0e5e9d"]]),gt={class:"participant-detail"},wt={class:"card-header"},bt={class:"header-actions"},ht={class:"section-header"},kt={class:"scoring-result"},Rt={class:"score-value"},Ct={class:"score-number"},Mt={class:"score-details"},xt={class:"score-section"},Vt={key:0},$t={class:"score-section"},St={key:0},Lt={key:0,class:"score-section"},Et={key:0,class:"final-report-actions"},Ot={style:{float:"right",color:"#8492a6","font-size":"13px"}},Ut={__name:"ParticipantDetailView",setup(s){const p=qe(),n=He(),y=nt(),T=v(!1),M=v(!1),U=v(!1),k=v(!1),D=v(!1),g=Y(()=>y.currentParticipant),L=v([]),z=v([]),I=v([]);v([]);const j=v(null),P=v(!1),B=v(!1),H=v(!1),q=v(null),X=v([]),r=Me({report_type:"",file:null}),R={report_type:[{required:!0,message:"Выберите тип отчёта",trigger:"change"}],file:[{required:!0,message:"Выберите файл",trigger:"change"}]},m=Me({activityCode:""}),i=l=>l?new Date(l).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",d=l=>({REPORT_1:"Отчёт 1",REPORT_2:"Отчёт 2",REPORT_3:"Отчёт 3"})[l]||l,V=l=>({UPLOADED:"Загружен",EXTRACTED:"Обработан",FAILED:"Ошибка"})[l]||l,G=l=>({UPLOADED:"info",EXTRACTED:"success",FAILED:"danger"})[l]||"info",re=l=>l>=80?"success":l>=60?"":"warning",ie=async()=>{T.value=!0;try{await y.getParticipant(n.params.id)}catch{b.error("Участник не найден"),p.push("/participants")}finally{T.value=!1}},Q=async()=>{M.value=!0;try{const l=await ot.getReports(n.params.id);L.value=l.items||[]}catch(l){console.error("Error loading reports:",l),b.error("Ошибка загрузки списка отчётов")}finally{M.value=!1}},ue=async()=>{try{const l=await ne.getHistory(n.params.id);z.value=l.items||[]}catch(l){console.error("Error loading scoring results:",l)}},de=async()=>{U.value=!0;try{const l=await lt.list();I.value=l.activities||[]}catch{b.error("Ошибка загрузки профессиональных областей")}finally{U.value=!1}},ce=l=>{r.file=l.raw,X.value=[l]},pe=async()=>{q.value&&await q.value.validate(async l=>{if(l){if(!r.file){b.error("Выберите файл");return}k.value=!0;try{await le.upload(n.params.id,r.report_type,r.file),b.success("Отчёт загружен успешно"),P.value=!1,r.report_type="",r.file=null,X.value=[],await Q()}catch{b.error("Ошибка загрузки отчёта")}finally{k.value=!1}}})},$=async l=>{try{const e=await le.download(l),w=window.URL.createObjectURL(new Blob([e.data])),x=document.createElement("a");x.href=w,x.setAttribute("download",`report_${l}.docx`),document.body.appendChild(x),x.click(),x.remove(),window.URL.revokeObjectURL(w),b.success("Отчёт скачан")}catch{b.error("Ошибка скачивания отчёта")}},me=async l=>{try{await le.extract(l),b.success("Извлечение метрик запущено"),setTimeout(()=>Q(),2e3)}catch{b.error("Ошибка запуска извлечения метрик")}},Se=async l=>{j.value=l,await et(),H.value=!0},Le=()=>{b.success("Метрики обновлены")},Ee=l=>{tt.confirm(`Вы уверены, что хотите удалить отчёт "${d(l.type)}"?`,"Подтверждение удаления",{confirmButtonText:"Удалить",cancelButtonText:"Отмена",type:"warning"}).then(async()=>{try{await le.delete(l.id),b.success("Отчёт удалён"),await Q()}catch{b.error("Ошибка удаления отчёта")}}).catch(()=>{})},Oe=async()=>{if(!m.activityCode){b.warning("Выберите профессиональную область");return}D.value=!0;try{const l=await ne.calculate(n.params.id,m.activityCode);z.value.unshift({id:l.scoring_result_id,prof_activity_code:l.prof_activity_code||m.activityCode,prof_activity_name:l.prof_activity_name,score_pct:parseFloat(l.score_pct),strengths:l.strengths||[],dev_areas:l.dev_areas||[],recommendations:l.recommendations||[],created_at:new Date().toISOString()}),b.success("Расчёт пригодности выполнен"),B.value=!1,m.activityCode=""}catch(l){console.error("Scoring calculation error:",l);const e=l.response?.data?.detail||"Ошибка расчёта пригодности";b.error(e)}finally{D.value=!1}},Ue=async l=>{if(!l.prof_activity_code){b.warning("Код профессиональной деятельности не найден");return}try{const e=await ne.getFinalReport(n.params.id,l.prof_activity_code,"json"),w=JSON.stringify(e,null,2),x=new Blob([w],{type:"application/json"}),A=window.URL.createObjectURL(x);window.open(A,"_blank"),window.URL.revokeObjectURL(A),b.success("Отчёт JSON открыт в новой вкладке")}catch(e){console.error("Error viewing final report JSON:",e);const w=e.response?.data?.detail||"Ошибка загрузки финального отчёта";b.error(w)}},De=async l=>{if(!l.prof_activity_code){b.warning("Код профессиональной деятельности не найден");return}try{const e=await ne.getFinalReport(n.params.id,l.prof_activity_code,"html"),w=new Blob([e],{type:"text/html"}),x=window.URL.createObjectURL(w),A=document.createElement("a");A.href=x,A.setAttribute("download",`final_report_${l.prof_activity_code}_${new Date().toISOString().split("T")[0]}.html`),document.body.appendChild(A),A.click(),A.remove(),window.URL.revokeObjectURL(x),b.success("Отчёт HTML скачан")}catch(e){console.error("Error downloading final report HTML:",e);const w=e.response?.data?.detail||"Ошибка загрузки финального отчёта";b.error(w)}};return $e(async()=>{await ie(),await Q(),await ue(),await de()}),(l,e)=>{const w=c("el-button"),x=c("el-icon"),A=c("el-descriptions-item"),Ae=c("el-descriptions"),ee=c("el-card"),he=c("el-tag"),te=c("el-table-column"),Ne=c("el-table"),fe=c("el-empty"),Te=c("el-progress"),Fe=c("el-timeline-item"),Ie=c("el-timeline"),ae=c("el-option"),ke=c("el-select"),_e=c("el-form-item"),Be=c("el-upload"),Re=c("el-form"),ve=c("el-dialog"),Ce=c("el-alert"),ye=Xe("loading");return u(),S(at,null,{default:t(()=>[ge((u(),C("div",gt,[g.value?(u(),S(ee,{key:0,class:"detail-card"},{header:t(()=>[_("div",wt,[_("h2",null,h(g.value.full_name),1),_("div",bt,[a(w,{onClick:e[0]||(e[0]=o=>O(p).back())},{default:t(()=>[...e[10]||(e[10]=[f(" Назад ",-1)])]),_:1}),a(w,{type:"primary",onClick:e[1]||(e[1]=o=>B.value=!0)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(Ge))]),_:1}),e[11]||(e[11]=f(" Рассчитать пригодность ",-1))]),_:1})])])]),default:t(()=>[a(Ae,{column:2,border:""},{default:t(()=>[a(A,{label:"ФИО"},{default:t(()=>[f(h(g.value.full_name),1)]),_:1}),a(A,{label:"Дата рождения"},{default:t(()=>[f(h(g.value.birth_date||"Не указана"),1)]),_:1}),a(A,{label:"Внешний ID"},{default:t(()=>[f(h(g.value.external_id||"Не указан"),1)]),_:1}),a(A,{label:"Дата создания"},{default:t(()=>[f(h(i(g.value.created_at)),1)]),_:1})]),_:1})]),_:1})):N("",!0),a(ee,{class:"section-card"},{header:t(()=>[_("div",ht,[e[13]||(e[13]=_("h3",null,"Отчёты",-1)),a(w,{type:"primary",onClick:e[2]||(e[2]=o=>P.value=!0)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(Ye))]),_:1}),e[12]||(e[12]=f(" Загрузить отчёт ",-1))]),_:1})])]),default:t(()=>[ge((u(),S(Ne,{data:L.value,stripe:""},{default:t(()=>[a(te,{prop:"type",label:"Тип",width:"120"},{default:t(({row:o})=>[a(he,null,{default:t(()=>[f(h(d(o.type)),1)]),_:2},1024)]),_:1}),a(te,{prop:"status",label:"Статус",width:"150"},{default:t(({row:o})=>[a(he,{type:G(o.status)},{default:t(()=>[f(h(V(o.status)),1)]),_:2},1032,["type"])]),_:1}),a(te,{prop:"created_at",label:"Дата загрузки",width:"180"},{default:t(({row:o})=>[f(h(i(o.created_at)),1)]),_:1}),a(te,{label:"Действия",width:"400",fixed:"right"},{default:t(({row:o})=>[a(w,{size:"small",onClick:E=>$(o.id)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(xe))]),_:1}),e[14]||(e[14]=f(" Скачать ",-1))]),_:1},8,["onClick"]),a(w,{size:"small",type:"primary",disabled:o.status==="EXTRACTED",onClick:E=>me(o.id)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(Ke))]),_:1}),e[15]||(e[15]=f(" Извлечь метрики ",-1))]),_:1},8,["disabled","onClick"]),a(w,{size:"small",type:"info",onClick:E=>Se(o.id)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(Qe))]),_:1}),e[16]||(e[16]=f(" Метрики ",-1))]),_:1},8,["onClick"]),a(w,{size:"small",type:"danger",onClick:E=>Ee(o)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(We))]),_:1}),e[17]||(e[17]=f(" Удалить ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ye,M.value]]),!L.value.length&&!M.value?(u(),S(fe,{key:0,description:"Нет загруженных отчётов"})):N("",!0)]),_:1}),z.value.length>0?(u(),S(ee,{key:1,class:"section-card"},{header:t(()=>[...e[18]||(e[18]=[_("h3",null,"История оценок пригодности",-1)])]),default:t(()=>[a(Ie,null,{default:t(()=>[(u(!0),C(J,null,K(z.value,o=>(u(),S(Fe,{key:o.id,timestamp:i(o.created_at),placement:"top"},{default:t(()=>[a(ee,null,{default:t(()=>[_("h4",null,h(o.prof_activity_name),1),_("div",kt,[_("div",Rt,[_("span",Ct,h(o.score_pct)+"%",1),a(Te,{percentage:o.score_pct,status:re(o.score_pct)},null,8,["percentage","status"])]),_("div",Mt,[_("div",xt,[e[19]||(e[19]=_("h5",null,"Сильные стороны:",-1)),o.strengths&&o.strengths.length?(u(),C("ul",Vt,[(u(!0),C(J,null,K(o.strengths,(E,Z)=>(u(),C("li",{key:Z},[_("strong",null,h(E.metric_name),1),f(" — "+h(O(oe)(E.value))+" (вес "+h(O(oe)(E.weight,2))+") ",1)]))),128))])):(u(),S(fe,{key:1,description:"Нет данных","image-size":60}))]),_("div",$t,[e[20]||(e[20]=_("h5",null,"Зоны развития:",-1)),o.dev_areas&&o.dev_areas.length?(u(),C("ul",St,[(u(!0),C(J,null,K(o.dev_areas,(E,Z)=>(u(),C("li",{key:Z},[_("strong",null,h(E.metric_name),1),f(" — "+h(O(oe)(E.value))+" (вес "+h(O(oe)(E.weight,2))+") ",1)]))),128))])):(u(),S(fe,{key:1,description:"Нет данных","image-size":60}))]),o.recommendations&&o.recommendations.length?(u(),C("div",Lt,[e[21]||(e[21]=_("h5",null,"Рекомендации:",-1)),_("ul",null,[(u(!0),C(J,null,K(o.recommendations,(E,Z)=>(u(),C("li",{key:Z},h(E),1))),128))])])):N("",!0)]),o.prof_activity_code?(u(),C("div",Et,[a(w,{type:"info",size:"small",onClick:E=>Ue(o)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(Ze))]),_:1}),e[22]||(e[22]=f(" Просмотреть JSON ",-1))]),_:1},8,["onClick"]),a(w,{type:"primary",size:"small",onClick:E=>De(o)},{default:t(()=>[a(x,null,{default:t(()=>[a(O(xe))]),_:1}),e[23]||(e[23]=f(" Скачать HTML ",-1))]),_:1},8,["onClick"])])):N("",!0)])]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})):N("",!0),a(ve,{modelValue:P.value,"onUpdate:modelValue":e[5]||(e[5]=o=>P.value=o),title:"Загрузить отчёт",width:"500px"},{footer:t(()=>[a(w,{onClick:e[4]||(e[4]=o=>P.value=!1)},{default:t(()=>[...e[26]||(e[26]=[f(" Отмена ",-1)])]),_:1}),a(w,{type:"primary",loading:k.value,onClick:pe},{default:t(()=>[...e[27]||(e[27]=[f(" Загрузить ",-1)])]),_:1},8,["loading"])]),default:t(()=>[a(Re,{ref_key:"uploadFormRef",ref:q,model:r,rules:R,"label-position":"top"},{default:t(()=>[a(_e,{label:"Тип отчёта",prop:"report_type"},{default:t(()=>[a(ke,{modelValue:r.report_type,"onUpdate:modelValue":e[3]||(e[3]=o=>r.report_type=o),placeholder:"Выберите тип",style:{width:"100%"}},{default:t(()=>[a(ae,{label:"Отчёт 1",value:"REPORT_1"}),a(ae,{label:"Отчёт 2",value:"REPORT_2"}),a(ae,{label:"Отчёт 3",value:"REPORT_3"})]),_:1},8,["modelValue"])]),_:1}),a(_e,{label:"Файл (DOCX)",prop:"file"},{default:t(()=>[a(Be,{ref:"uploadRef","auto-upload":!1,limit:1,accept:".docx","on-change":ce,"file-list":X.value},{tip:t(()=>[...e[25]||(e[25]=[_("div",{class:"el-upload__tip"}," Только файлы DOCX, максимум 20 МБ ",-1)])]),default:t(()=>[a(w,{type:"primary"},{default:t(()=>[...e[24]||(e[24]=[f(" Выбрать файл ",-1)])]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(ve,{modelValue:B.value,"onUpdate:modelValue":e[8]||(e[8]=o=>B.value=o),title:"Рассчитать профессиональную пригодность",width:"500px"},{footer:t(()=>[a(w,{onClick:e[7]||(e[7]=o=>B.value=!1)},{default:t(()=>[...e[28]||(e[28]=[f(" Отмена ",-1)])]),_:1}),a(w,{type:"primary",loading:D.value,disabled:!m.activityCode||L.value.length===0,onClick:Oe},{default:t(()=>[...e[29]||(e[29]=[f(" Рассчитать ",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[a(Re,{model:m,"label-position":"top"},{default:t(()=>[a(_e,{label:"Профессиональная область",required:""},{default:t(()=>[ge((u(),S(ke,{modelValue:m.activityCode,"onUpdate:modelValue":e[6]||(e[6]=o=>m.activityCode=o),placeholder:"Выберите область",style:{width:"100%"}},{default:t(()=>[(u(!0),C(J,null,K(I.value,o=>(u(),S(ae,{key:o.code,label:o.name,value:o.code},{default:t(()=>[_("span",null,h(o.name),1),_("span",Ot,h(o.code),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])),[[ye,U.value]])]),_:1}),a(Ce,{title:"Убедитесь, что у участника загружены и обработаны отчёты с метриками",type:"info",closable:!1,"show-icon":""}),L.value.length===0?(u(),S(Ce,{key:0,title:"У участника нет загруженных отчётов",type:"warning",closable:!1,"show-icon":"",style:{"margin-top":"12px"}})):N("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(ve,{modelValue:H.value,"onUpdate:modelValue":e[9]||(e[9]=o=>H.value=o),title:"Метрики отчёта",width:"90%",top:"5vh"},{default:t(()=>[j.value?(u(),S(yt,{key:0,"report-id":j.value,onMetricsUpdated:Le},null,8,["report-id"])):N("",!0)]),_:1},8,["modelValue"])])),[[ye,T.value]])]),_:1})}}},It=be(Ut,[["__scopeId","data-v-2b9b8b4f"]]);export{It as default};
