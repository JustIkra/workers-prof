import{A as C}from"./AppLayout-_whA08tY.js";import{G as h,U as D,m as v,z as S,E as g,q as u,w as t,r as d,A as V,o as _,a as m,d as o,B,M as w,u as f,f as y}from"./index-BAHjXxBQ.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={async getPendingUsers(){return(await h.get("/admin/pending-users")).data},async approveUser(n){return(await h.post(`/admin/approve/${n}`)).data}},E=D("admin",()=>{const n=v([]),e=v(!1),s=v(null);async function l(){e.value=!0,s.value=null;try{const a=await U.getPendingUsers();return n.value=a,a}catch(a){throw s.value=a.response?.data?.detail||"Ошибка загрузки пользователей",a}finally{e.value=!1}}async function r(a){e.value=!0,s.value=null;try{const i=await U.approveUser(a);return n.value=n.value.filter(c=>c.id!==a),i}catch(i){throw s.value=i.response?.data?.detail||"Ошибка одобрения пользователя",i}finally{e.value=!1}}return{pendingUsers:n,loading:e,error:s,fetchPendingUsers:l,approveUser:r}}),M={class:"admin-users-view"},N={__name:"AdminUsersView",setup(n){const e=E(),s=async l=>{try{await e.approveUser(l.id),g.success(`Пользователь ${l.email} одобрен`)}catch{g.error(e.error||"Ошибка одобрения пользователя")}};return S(async()=>{try{await e.fetchPendingUsers()}catch{g.error("Ошибка загрузки пользователей")}}),(l,r)=>{const a=d("el-card"),i=d("el-empty"),c=d("el-table-column"),b=d("el-tag"),A=d("el-button"),k=d("el-table"),x=V("loading");return _(),u(C,null,{default:t(()=>[m("div",M,[o(a,{class:"header-card"},{default:t(()=>[...r[0]||(r[0]=[m("h1",null,"Управление пользователями",-1),m("p",null,"Одобрение новых пользователей системы",-1)])]),_:1}),B((_(),u(a,{class:"users-card"},{default:t(()=>[m("h3",null,"Ожидают одобрения ("+w(f(e).pendingUsers.length)+")",1),f(e).pendingUsers.length===0?(_(),u(i,{key:0,description:"Нет пользователей, ожидающих одобрения"})):(_(),u(k,{key:1,data:f(e).pendingUsers,stripe:""},{default:t(()=>[o(c,{prop:"email",label:"Email","min-width":"250"}),o(c,{label:"Статус",width:"120"},{default:t(({row:p})=>[o(b,{type:"warning"},{default:t(()=>[y(w(p.status),1)]),_:2},1024)]),_:1}),o(c,{prop:"created_at",label:"Дата регистрации",width:"180"},{default:t(({row:p})=>[y(w(new Date(p.created_at).toLocaleDateString("ru-RU")),1)]),_:1}),o(c,{label:"Действия",width:"150",fixed:"right"},{default:t(({row:p})=>[o(A,{type:"success",size:"small",onClick:$=>s(p)},{default:t(()=>[...r[1]||(r[1]=[y(" Одобрить ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]))]),_:1})),[[x,f(e).loading]])])]),_:1})}}},G=P(N,[["__scopeId","data-v-dad4b201"]]);export{G as default};
