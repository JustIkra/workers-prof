import{G as i,a1 as h,m as c}from"./index-D30CotXF.js";const u={async create(t){return(await i.post("/participants",t)).data},async search(t={}){return(await i.get("/participants",{params:t})).data},async getById(t){return(await i.get(`/participants/${t}`)).data},async update(t,e){return(await i.put(`/participants/${t}`,e)).data},async delete(t){return(await i.delete(`/participants/${t}`)).data},async getReports(t){return(await i.get(`/participants/${t}/reports`)).data},async getMetrics(t){return(await i.get(`/participants/${t}/metrics`)).data},async updateMetric(t,e,s){return(await i.put(`/participants/${t}/metrics/${e}`,s)).data}},$=h("participants",()=>{const t=c([]),e=c(null),s=c(!1),r=c(null),o=c({total:0,page:1,size:20,totalPages:0});async function d(n={}){s.value=!0,r.value=null;try{const a=await u.search(n);return t.value=a.items,o.value={total:a.total,page:a.page,size:a.size,totalPages:Math.ceil(a.total/a.size)},a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка загрузки участников",a}finally{s.value=!1}}async function v(n){s.value=!0,r.value=null;try{const a=await u.getById(n);return e.value=a,a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка загрузки участника",a}finally{s.value=!1}}async function f(n){s.value=!0,r.value=null;try{const a=await u.create(n);return t.value.unshift(a),a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка создания участника",a}finally{s.value=!1}}async function y(n,a){s.value=!0,r.value=null;try{const l=await u.update(n,a),p=t.value.findIndex(g=>g.id===n);return p!==-1&&(t.value[p]=l),e.value?.id===n&&(e.value=l),l}catch(l){throw r.value=l.response?.data?.detail||"Ошибка обновления участника",l}finally{s.value=!1}}async function w(n){s.value=!0,r.value=null;try{await u.delete(n),t.value=t.value.filter(a=>a.id!==n),e.value?.id===n&&(e.value=null)}catch(a){throw r.value=a.response?.data?.detail||"Ошибка удаления участника",a}finally{s.value=!1}}return{participants:t,currentParticipant:e,loading:s,error:r,pagination:o,searchParticipants:d,getParticipant:v,createParticipant:f,updateParticipant:y,deleteParticipant:w}});export{u as p,$ as u};
