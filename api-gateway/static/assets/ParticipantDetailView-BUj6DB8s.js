import{G as F,m as f,H as W,I as be,r as d,c as M,o as r,d as a,v as O,J as He,w as t,u as A,K as qe,C as Xe,L as Ke,M as k,N as H,z as Oe,q as C,f as m,O as Q,a as v,E as b,n as Ve,P as Qe,p as We,e as Ye,A as Ze,B as ge,t as et,Q as Ee,h as tt,R as $e,S as at,T as lt,U as nt,V as ot,F as st}from"./index-D8-0gMTI.js";import{A as rt}from"./AppLayout-Ct5KKSd7.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{m as we,p as it}from"./metrics-VgHZuQX0.js";import{u as ut,p as ct}from"./participants-CK_YDlTX.js";const le={async upload(s,_,o){const g=new FormData;return g.append("report_type",_),g.append("file",o),(await F.post(`/participants/${s}/reports`,g,{headers:{"Content-Type":"multipart/form-data"}})).data},async download(s){return await F.get(`/reports/${s}/download`,{responseType:"blob"})},async getById(s){return(await F.get(`/reports/${s}`)).data},async delete(s){return(await F.delete(`/reports/${s}`)).data},async extract(s){return(await F.post(`/reports/${s}/extract`)).data},async getMetrics(s){return(await F.get(`/reports/${s}/metrics`)).data},async getList(s){return(await F.get(`/participants/${s}/reports`)).data}},ne={async calculate(s,_){return(await F.post(`/scoring/participants/${s}/calculate`,null,{params:{activity_code:_}})).data},async getHistory(s,_=10){return(await F.get(`/scoring/participants/${s}/scores`,{params:{limit:_}})).data},async getById(s){return(await F.get(`/scoring-results/${s}`)).data},async generateRecommendations(s){return(await F.post(`/reports/${s}/recommendations`)).data},async getFinalReport(s,_,o="json"){const g={params:{activity_code:_,format:o}};o==="html"&&(g.responseType="text");const T=await F.get(`/participants/${s}/final-report`,g);return T.data}};function se(s,_=1){if(s==null||s==="")return"";const o=typeof s=="string"?parseFloat(s):s;return isNaN(o)?"":o.toLocaleString("ru-RU",{minimumFractionDigits:_,maximumFractionDigits:_})}function Y(s){if(s==null||s==="")return null;const o=String(s).trim().replace(",","."),g=parseFloat(o);return isNaN(g)?null:g}function dt(s){return Y(s)}function oe(s,_=1){return se(s,_)}const pt={key:0,class:"error-message"},mt={__name:"MetricInput",props:{modelValue:{type:[Number,String],default:null},min:{type:Number,default:1},max:{type:Number,default:10},step:{type:Number,default:.1},precision:{type:Number,default:1},placeholder:{type:String,default:"Введите значение"},disabled:{type:Boolean,default:!1},showControls:{type:Boolean,default:!0}},emits:["update:modelValue","change","blur"],setup(s,{emit:_}){const o=s,g=_,T=f(null),S=f(""),D=f(!1),R=f(!1),U=f(""),w=W(()=>Y(S.value)),E=W(()=>{const c=w.value;return c===null||c<=o.min}),P=W(()=>{const c=w.value;return c===null||c>=o.max}),I=c=>{if(c==null||c===""){S.value="";return}D.value?S.value=String(c).replace(".",","):S.value=se(c,o.precision)},J=c=>{if(c==null||c==="")return R.value=!1,U.value="",!0;const h=Y(c);return h===null?(R.value=!0,U.value="Некорректное число",!1):h<o.min?(R.value=!0,U.value=`Значение должно быть не меньше ${se(o.min,o.precision)}`,!1):h>o.max?(R.value=!0,U.value=`Значение должно быть не больше ${se(o.max,o.precision)}`,!1):(R.value=!1,U.value="",!0)},z=c=>{const h=c.replace(/[^\d,.-]/g,"");let p=!1;const i=h.split("").filter(x=>x===","||x==="."?p?!1:(p=!0,!0):!0).join("").replace(".",",");S.value=i;const u=Y(i);u!==null?g("update:modelValue",u):(i===""||i==="-")&&g("update:modelValue",null)},q=()=>{D.value=!1;const c=Y(S.value);if(J(S.value)){if(c!==null){const h=Math.round(c*Math.pow(10,o.precision))/Math.pow(10,o.precision),p=Math.max(o.min,Math.min(o.max,h));g("update:modelValue",p),I(p),g("change",p)}}else if(c!==null&&(c<o.min||c>o.max)){const h=Math.max(o.min,Math.min(o.max,c));g("update:modelValue",h),I(h),g("change",h),R.value=!1,U.value=""}g("blur")},B=()=>{D.value=!0,w.value!==null&&(S.value=String(w.value).replace(".",","))},j=()=>{const c=w.value||0,h=Math.min(o.max,c+o.step),p=Math.round(h*Math.pow(10,o.precision))/Math.pow(10,o.precision);g("update:modelValue",p),g("change",p),I(p)},X=()=>{const c=w.value||0,h=Math.max(o.min,c-o.step),p=Math.round(h*Math.pow(10,o.precision))/Math.pow(10,o.precision);g("update:modelValue",p),g("change",p),I(p)};return be(()=>o.modelValue,c=>{I(c)},{immediate:!0}),I(o.modelValue),(c,h)=>{const p=d("el-button"),i=d("el-button-group"),u=d("el-input");return r(),M(H,null,[a(u,{ref_key:"inputRef",ref:T,modelValue:S.value,"onUpdate:modelValue":h[0]||(h[0]=x=>S.value=x),placeholder:s.placeholder,disabled:s.disabled,class:Ke({"is-invalid":R.value}),onInput:z,onBlur:q,onFocus:B},He({_:2},[s.showControls?{name:"append",fn:t(()=>[a(i,null,{default:t(()=>[a(p,{icon:A(qe),disabled:s.disabled||E.value,onClick:X},null,8,["icon","disabled"]),a(p,{icon:A(Xe),disabled:s.disabled||P.value,onClick:j},null,8,["icon","disabled"])]),_:1})]),key:"0"}:void 0]),1032,["modelValue","placeholder","disabled","class"]),R.value?(r(),M("div",pt,k(U.value),1)):O("",!0)],64)}}},ft=he(mt,[["__scopeId","data-v-74ef628d"]]),_t={class:"card-header"},vt={key:1},yt={key:0,class:"metric-description"},gt={key:2,class:"metrics-info"},wt={class:"info-row"},bt={key:0,class:"info-row"},ht={__name:"MetricsEditor",props:{reportId:{type:String,required:!0}},emits:["metrics-updated"],setup(s,{emit:_}){const o=s,g=_,T=f(!1),S=f(!1),D=f(!1),R=f(null),U=f([]),w=f([]),E=f({metrics:{}}),P=f({}),I=W(()=>!w.value||w.value.length===0?[]:[...new Set(w.value.map(i=>i.source))]),J=W(()=>!w.value||w.value.length===0?null:new Date),z=async()=>{try{const i=await we.listMetricDefs(!0);U.value=i.items||[]}catch(i){console.error("Failed to load metric definitions:",i),R.value="Не удалось загрузить определения метрик"}},q=async()=>{T.value=!0,R.value=null;try{const i=await we.listExtractedMetrics(o.reportId);w.value=i.items||[],E.value.metrics={},w.value.forEach(u=>{E.value.metrics[u.metric_def_id]=Y(u.value)}),P.value=JSON.parse(JSON.stringify(E.value.metrics))}catch(i){console.error("Failed to load metrics:",i),R.value="Не удалось загрузить метрики"}finally{T.value=!1}},B=()=>{D.value=!0,P.value=JSON.parse(JSON.stringify(E.value.metrics))},j=()=>{E.value.metrics=JSON.parse(JSON.stringify(P.value)),D.value=!1,R.value=null},X=async()=>{S.value=!0,R.value=null;try{const i=[];for(const[u,x]of Object.entries(E.value.metrics))if(x!=null&&x!==""){const G=dt(x);G!==null&&i.push({metric_def_id:u,value:G,source:"MANUAL",notes:null})}if(i.length===0){b.warning("Не введено ни одного значения метрики"),S.value=!1;return}await we.bulkCreateExtractedMetrics(o.reportId,i),b.success(`Успешно сохранено ${i.length} метрик`),D.value=!1,await q(),g("metrics-updated")}catch(i){console.error("Failed to save metrics:",i);let u="Не удалось сохранить метрики";i.response?.data?.detail&&(typeof i.response.data.detail=="string"?u=i.response.data.detail:Array.isArray(i.response.data.detail)&&(u=i.response.data.detail.map(x=>x.msg||x.message).join(", "))),R.value=u,b.error(u)}finally{S.value=!1}},c=i=>{switch(i){case"OCR":return"info";case"LLM":return"warning";case"MANUAL":return"success";default:return""}},h=i=>{switch(i){case"OCR":return"OCR";case"LLM":return"Gemini Vision";case"MANUAL":return"Ручной ввод";default:return i}},p=i=>new Date(i).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return Oe(async()=>{await z(),await q()}),be(()=>o.reportId,async i=>{i&&await q()}),(i,u)=>{const x=d("el-button"),G=d("el-alert"),re=d("el-form-item"),ie=d("el-col"),ue=d("el-row"),ce=d("el-form"),K=d("el-divider"),de=d("el-tag"),pe=d("el-card");return r(),C(pe,{class:"metrics-editor"},{header:t(()=>[v("div",_t,[u[4]||(u[4]=v("span",null,"Ручной ввод метрик",-1)),D.value?(r(),M("div",vt,[a(x,{size:"small",onClick:j},{default:t(()=>[...u[2]||(u[2]=[m(" Отмена ",-1)])]),_:1}),a(x,{type:"primary",size:"small",loading:S.value,onClick:X},{default:t(()=>[...u[3]||(u[3]=[m(" Сохранить ",-1)])]),_:1},8,["loading"])])):(r(),C(x,{key:0,type:"primary",size:"small",onClick:B},{default:t(()=>[...u[1]||(u[1]=[m(" Редактировать ",-1)])]),_:1}))])]),default:t(()=>[R.value?(r(),C(G,{key:0,type:"error",title:R.value,closable:"",style:{"margin-bottom":"16px"},onClose:u[0]||(u[0]=$=>R.value=null)},null,8,["title"])):O("",!0),!w.value||w.value.length===0?(r(),C(G,{key:1,type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...u[5]||(u[5]=[m(" Метрики для этого отчёта ещё не извлечены. Вы можете ввести их вручную. ",-1)])]),_:1})):O("",!0),a(ce,{ref:"formRef",model:E.value,"label-position":"top",disabled:!D.value},{default:t(()=>[a(ue,{gutter:20},{default:t(()=>[(r(!0),M(H,null,Q(U.value,$=>(r(),C(ie,{key:$.id,xs:24,sm:12,md:8,lg:6},{default:t(()=>[a(re,{label:`${$.name} ${$.unit?"("+$.unit+")":""}`,prop:`metrics.${$.id}`},{default:t(()=>[a(ft,{modelValue:E.value.metrics[$.id],"onUpdate:modelValue":me=>E.value.metrics[$.id]=me,min:$.min_value||1,max:$.max_value||10,precision:1,step:.1,disabled:!D.value,"show-controls":!0,placeholder:"Введите значение (например: 7,5)"},null,8,["modelValue","onUpdate:modelValue","min","max","disabled"]),$.description?(r(),M("div",yt,k($.description),1)):O("",!0)]),_:2},1032,["label","prop"])]),_:2},1024))),128))]),_:1})]),_:1},8,["model","disabled"]),w.value&&w.value.length>0?(r(),M("div",gt,[a(K),v("div",wt,[u[6]||(u[6]=v("span",{class:"info-label"},"Источник данных:",-1)),(r(!0),M(H,null,Q(I.value,$=>(r(),C(de,{key:$,type:c($),size:"small",style:{"margin-left":"8px"}},{default:t(()=>[m(k(h($)),1)]),_:2},1032,["type"]))),128))]),J.value?(r(),M("div",bt,[u[7]||(u[7]=v("span",{class:"info-label"},"Последнее обновление:",-1)),v("span",null,k(p(J.value)),1)])):O("",!0)])):O("",!0)]),_:1})}}},kt=he(ht,[["__scopeId","data-v-bb0e5e9d"]]),Rt={class:"participant-detail"},Ct={class:"card-header"},Mt={class:"header-actions"},St={class:"section-header"},xt={class:"scoring-result"},Vt={class:"score-value"},Et={class:"score-number"},$t={class:"score-details"},Ot={class:"score-section"},Lt={key:0},At={class:"score-section"},Dt={key:0},Ut={key:0,class:"score-section"},Nt={key:0,class:"final-report-actions"},Tt={style:{float:"right",color:"#8492a6","font-size":"13px"}},Ft={__name:"ParticipantDetailView",setup(s){const _=Ye(),o=We(),g=ut(),T=f(!1),S=f(!1),D=f(!1),R=f(!1),U=f(!1),w=W(()=>g.currentParticipant),E=f([]),P=f([]),I=f([]);f([]);const J=f(null),z=f(null),q=W(()=>E.value.some(l=>l.status==="PROCESSING")),B=f(!1),j=f(!1),X=f(!1),c=f(null),h=f([]),p=Ve({report_type:"",file:null}),i={report_type:[{required:!0,message:"Выберите тип отчёта",trigger:"change"}],file:[{required:!0,message:"Выберите файл",trigger:"change"}]},u=Ve({activityCode:""}),x=l=>l?new Date(l).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",G=l=>({REPORT_1:"Отчёт 1",REPORT_2:"Отчёт 2",REPORT_3:"Отчёт 3"})[l]||l,re=l=>({UPLOADED:"Загружен",PROCESSING:"Извлечение метрик...",EXTRACTED:"Метрики извлечены",FAILED:"Ошибка"})[l]||l,ie=l=>({UPLOADED:"info",PROCESSING:"warning",EXTRACTED:"success",FAILED:"danger"})[l]||"info",ue=l=>l>=80?"success":l>=60?"":"warning",ce=async()=>{T.value=!0;try{await g.getParticipant(o.params.id)}catch{b.error("Участник не найден"),_.push("/participants")}finally{T.value=!1}},K=async()=>{S.value=!0;try{const l=await ct.getReports(o.params.id);E.value=l.items||[]}catch(l){console.error("Error loading reports:",l),b.error("Ошибка загрузки списка отчётов")}finally{S.value=!1}},de=async()=>{try{const l=await ne.getHistory(o.params.id);P.value=l.items||[]}catch(l){console.error("Error loading scoring results:",l)}},pe=async()=>{D.value=!0;try{const l=await it.list();I.value=l.activities||[]}catch{b.error("Ошибка загрузки профессиональных областей")}finally{D.value=!1}},$=l=>{p.file=l.raw,h.value=[l]},me=async()=>{c.value&&await c.value.validate(async l=>{if(l){if(!p.file){b.error("Выберите файл");return}R.value=!0;try{await le.upload(o.params.id,p.report_type,p.file),b.success("Отчёт загружен успешно"),B.value=!1,p.report_type="",p.file=null,h.value=[],await K()}catch{b.error("Ошибка загрузки отчёта")}finally{R.value=!1}}})},Le=async l=>{try{const e=await le.download(l),y=window.URL.createObjectURL(new Blob([e.data])),V=document.createElement("a");V.href=y,V.setAttribute("download",`report_${l}.docx`),document.body.appendChild(V),V.click(),V.remove(),window.URL.revokeObjectURL(y),b.success("Отчёт скачан")}catch{b.error("Ошибка скачивания отчёта")}},Ae=async l=>{try{await le.extract(l),b.success("Извлечение метрик запущено"),await K()}catch{b.error("Ошибка запуска извлечения метрик")}},De=()=>{z.value||(z.value=setInterval(async()=>{try{await K()}catch(l){console.error("Auto-refresh error:",l)}},3e3))},ke=()=>{z.value&&(clearInterval(z.value),z.value=null)};be(q,l=>{l?De():ke()});const Re=async l=>{J.value=l,await ot(),X.value=!0},Ue=()=>{b.success("Метрики обновлены")},Ne=l=>{st.confirm(`Вы уверены, что хотите удалить отчёт "${G(l.type)}"?`,"Подтверждение удаления",{confirmButtonText:"Удалить",cancelButtonText:"Отмена",type:"warning"}).then(async()=>{try{await le.delete(l.id),b.success("Отчёт удалён"),await K()}catch{b.error("Ошибка удаления отчёта")}}).catch(()=>{})},Te=async()=>{if(!u.activityCode){b.warning("Выберите профессиональную область");return}U.value=!0;try{const l=await ne.calculate(o.params.id,u.activityCode);P.value.unshift({id:l.scoring_result_id,prof_activity_code:l.prof_activity_code||u.activityCode,prof_activity_name:l.prof_activity_name,score_pct:parseFloat(l.score_pct),strengths:l.strengths||[],dev_areas:l.dev_areas||[],recommendations:l.recommendations||[],created_at:new Date().toISOString()}),b.success("Расчёт пригодности выполнен"),j.value=!1,u.activityCode=""}catch(l){console.error("Scoring calculation error:",l);const e=l.response?.data?.detail||"Ошибка расчёта пригодности";b.error(e)}finally{U.value=!1}},Fe=async l=>{if(!l.prof_activity_code){b.warning("Код профессиональной деятельности не найден");return}try{const e=await ne.getFinalReport(o.params.id,l.prof_activity_code,"json"),y=JSON.stringify(e,null,2),V=new Blob([y],{type:"application/json"}),N=window.URL.createObjectURL(V);window.open(N,"_blank"),window.URL.revokeObjectURL(N),b.success("Отчёт JSON открыт в новой вкладке")}catch(e){console.error("Error viewing final report JSON:",e);const y=e.response?.data?.detail||"Ошибка загрузки финального отчёта";b.error(y)}},Ie=async l=>{if(!l.prof_activity_code){b.warning("Код профессиональной деятельности не найден");return}try{const e=await ne.getFinalReport(o.params.id,l.prof_activity_code,"html"),y=new Blob([e],{type:"text/html"}),V=window.URL.createObjectURL(y),N=document.createElement("a");N.href=V,N.setAttribute("download",`final_report_${l.prof_activity_code}_${new Date().toISOString().split("T")[0]}.html`),document.body.appendChild(N),N.click(),N.remove(),window.URL.revokeObjectURL(V),b.success("Отчёт HTML скачан")}catch(e){console.error("Error downloading final report HTML:",e);const y=e.response?.data?.detail||"Ошибка загрузки финального отчёта";b.error(y)}};return Oe(async()=>{await ce(),await K(),await de(),await pe()}),Qe(()=>{ke()}),(l,e)=>{const y=d("el-button"),V=d("el-icon"),N=d("el-descriptions-item"),Pe=d("el-descriptions"),ee=d("el-card"),Ce=d("el-tag"),te=d("el-table-column"),ze=d("el-table"),fe=d("el-empty"),Be=d("el-progress"),je=d("el-timeline-item"),Je=d("el-timeline"),ae=d("el-option"),Me=d("el-select"),_e=d("el-form-item"),Ge=d("el-upload"),Se=d("el-form"),ve=d("el-dialog"),xe=d("el-alert"),ye=Ze("loading");return r(),C(rt,null,{default:t(()=>[ge((r(),M("div",Rt,[w.value?(r(),C(ee,{key:0,class:"detail-card"},{header:t(()=>[v("div",Ct,[v("h2",null,k(w.value.full_name),1),v("div",Mt,[a(y,{onClick:e[0]||(e[0]=n=>A(_).back())},{default:t(()=>[...e[10]||(e[10]=[m(" Назад ",-1)])]),_:1}),a(y,{type:"primary",onClick:e[1]||(e[1]=n=>j.value=!0)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(et))]),_:1}),e[11]||(e[11]=m(" Рассчитать пригодность ",-1))]),_:1})])])]),default:t(()=>[a(Pe,{column:2,border:""},{default:t(()=>[a(N,{label:"ФИО"},{default:t(()=>[m(k(w.value.full_name),1)]),_:1}),a(N,{label:"Дата рождения"},{default:t(()=>[m(k(w.value.birth_date||"Не указана"),1)]),_:1}),a(N,{label:"Внешний ID"},{default:t(()=>[m(k(w.value.external_id||"Не указан"),1)]),_:1}),a(N,{label:"Дата создания"},{default:t(()=>[m(k(x(w.value.created_at)),1)]),_:1})]),_:1})]),_:1})):O("",!0),a(ee,{class:"section-card"},{header:t(()=>[v("div",St,[e[13]||(e[13]=v("h3",null,"Отчёты",-1)),a(y,{type:"primary",onClick:e[2]||(e[2]=n=>B.value=!0)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(lt))]),_:1}),e[12]||(e[12]=m(" Загрузить отчёт ",-1))]),_:1})])]),default:t(()=>[ge((r(),C(ze,{data:E.value,stripe:""},{default:t(()=>[a(te,{prop:"type",label:"Тип",width:"120"},{default:t(({row:n})=>[a(Ce,null,{default:t(()=>[m(k(G(n.type)),1)]),_:2},1024)]),_:1}),a(te,{prop:"status",label:"Статус",width:"150"},{default:t(({row:n})=>[a(Ce,{type:ie(n.status)},{default:t(()=>[m(k(re(n.status)),1)]),_:2},1032,["type"])]),_:1}),a(te,{prop:"created_at",label:"Дата загрузки",width:"180"},{default:t(({row:n})=>[m(k(x(n.created_at)),1)]),_:1}),a(te,{label:"Действия",width:"450",fixed:"right"},{default:t(({row:n})=>[a(y,{size:"small",onClick:L=>Le(n.id)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(Ee))]),_:1}),e[14]||(e[14]=m(" Скачать ",-1))]),_:1},8,["onClick"]),n.status==="UPLOADED"||n.status==="FAILED"?(r(),C(y,{key:0,size:"small",type:"primary",onClick:L=>Ae(n.id)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(tt))]),_:1}),m(" "+k(n.status==="FAILED"?"Повторить":"Извлечь метрики"),1)]),_:2},1032,["onClick"])):O("",!0),n.status==="PROCESSING"?(r(),C(y,{key:1,size:"small",type:"primary",loading:!0,disabled:""},{default:t(()=>[...e[15]||(e[15]=[m(" Извлечение... ",-1)])]),_:1})):O("",!0),n.status==="EXTRACTED"?(r(),C(y,{key:2,size:"small",type:"success",onClick:L=>Re(n.id)},{default:t(()=>[a(V,null,{default:t(()=>[a(A($e))]),_:1}),e[16]||(e[16]=m(" Редактировать метрики ",-1))]),_:1},8,["onClick"])):O("",!0),n.status==="PROCESSING"||n.status==="EXTRACTED"?(r(),C(y,{key:3,size:"small",type:"info",onClick:L=>Re(n.id)},{default:t(()=>[a(V,null,{default:t(()=>[a(A($e))]),_:1}),e[17]||(e[17]=m(" Просмотр ",-1))]),_:1},8,["onClick"])):O("",!0),a(y,{size:"small",type:"danger",onClick:L=>Ne(n)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(at))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ye,S.value]]),!E.value.length&&!S.value?(r(),C(fe,{key:0,description:"Нет загруженных отчётов"})):O("",!0)]),_:1}),P.value.length>0?(r(),C(ee,{key:1,class:"section-card"},{header:t(()=>[...e[18]||(e[18]=[v("h3",null,"История оценок пригодности",-1)])]),default:t(()=>[a(Je,null,{default:t(()=>[(r(!0),M(H,null,Q(P.value,n=>(r(),C(je,{key:n.id,timestamp:x(n.created_at),placement:"top"},{default:t(()=>[a(ee,null,{default:t(()=>[v("h4",null,k(n.prof_activity_name),1),v("div",xt,[v("div",Vt,[v("span",Et,k(n.score_pct)+"%",1),a(Be,{percentage:n.score_pct,status:ue(n.score_pct)},null,8,["percentage","status"])]),v("div",$t,[v("div",Ot,[e[19]||(e[19]=v("h5",null,"Сильные стороны:",-1)),n.strengths&&n.strengths.length?(r(),M("ul",Lt,[(r(!0),M(H,null,Q(n.strengths,(L,Z)=>(r(),M("li",{key:Z},[v("strong",null,k(L.metric_name),1),m(" — "+k(A(oe)(L.value))+" (вес "+k(A(oe)(L.weight,2))+") ",1)]))),128))])):(r(),C(fe,{key:1,description:"Нет данных","image-size":60}))]),v("div",At,[e[20]||(e[20]=v("h5",null,"Зоны развития:",-1)),n.dev_areas&&n.dev_areas.length?(r(),M("ul",Dt,[(r(!0),M(H,null,Q(n.dev_areas,(L,Z)=>(r(),M("li",{key:Z},[v("strong",null,k(L.metric_name),1),m(" — "+k(A(oe)(L.value))+" (вес "+k(A(oe)(L.weight,2))+") ",1)]))),128))])):(r(),C(fe,{key:1,description:"Нет данных","image-size":60}))]),n.recommendations&&n.recommendations.length?(r(),M("div",Ut,[e[21]||(e[21]=v("h5",null,"Рекомендации:",-1)),v("ul",null,[(r(!0),M(H,null,Q(n.recommendations,(L,Z)=>(r(),M("li",{key:Z},k(L),1))),128))])])):O("",!0)]),n.prof_activity_code?(r(),M("div",Nt,[a(y,{type:"info",size:"small",onClick:L=>Fe(n)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(nt))]),_:1}),e[22]||(e[22]=m(" Просмотреть JSON ",-1))]),_:1},8,["onClick"]),a(y,{type:"primary",size:"small",onClick:L=>Ie(n)},{default:t(()=>[a(V,null,{default:t(()=>[a(A(Ee))]),_:1}),e[23]||(e[23]=m(" Скачать HTML ",-1))]),_:1},8,["onClick"])])):O("",!0)])]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})):O("",!0),a(ve,{modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=n=>B.value=n),title:"Загрузить отчёт",width:"500px"},{footer:t(()=>[a(y,{onClick:e[4]||(e[4]=n=>B.value=!1)},{default:t(()=>[...e[26]||(e[26]=[m(" Отмена ",-1)])]),_:1}),a(y,{type:"primary",loading:R.value,onClick:me},{default:t(()=>[...e[27]||(e[27]=[m(" Загрузить ",-1)])]),_:1},8,["loading"])]),default:t(()=>[a(Se,{ref_key:"uploadFormRef",ref:c,model:p,rules:i,"label-position":"top"},{default:t(()=>[a(_e,{label:"Тип отчёта",prop:"report_type"},{default:t(()=>[a(Me,{modelValue:p.report_type,"onUpdate:modelValue":e[3]||(e[3]=n=>p.report_type=n),placeholder:"Выберите тип",style:{width:"100%"}},{default:t(()=>[a(ae,{label:"Отчёт 1",value:"REPORT_1"}),a(ae,{label:"Отчёт 2",value:"REPORT_2"}),a(ae,{label:"Отчёт 3",value:"REPORT_3"})]),_:1},8,["modelValue"])]),_:1}),a(_e,{label:"Файл (DOCX)",prop:"file"},{default:t(()=>[a(Ge,{ref:"uploadRef","auto-upload":!1,limit:1,accept:".docx","on-change":$,"file-list":h.value},{tip:t(()=>[...e[25]||(e[25]=[v("div",{class:"el-upload__tip"}," Только файлы DOCX, максимум 20 МБ ",-1)])]),default:t(()=>[a(y,{type:"primary"},{default:t(()=>[...e[24]||(e[24]=[m(" Выбрать файл ",-1)])]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(ve,{modelValue:j.value,"onUpdate:modelValue":e[8]||(e[8]=n=>j.value=n),title:"Рассчитать профессиональную пригодность",width:"500px"},{footer:t(()=>[a(y,{onClick:e[7]||(e[7]=n=>j.value=!1)},{default:t(()=>[...e[28]||(e[28]=[m(" Отмена ",-1)])]),_:1}),a(y,{type:"primary",loading:U.value,disabled:!u.activityCode||E.value.length===0,onClick:Te},{default:t(()=>[...e[29]||(e[29]=[m(" Рассчитать ",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[a(Se,{model:u,"label-position":"top"},{default:t(()=>[a(_e,{label:"Профессиональная область",required:""},{default:t(()=>[ge((r(),C(Me,{modelValue:u.activityCode,"onUpdate:modelValue":e[6]||(e[6]=n=>u.activityCode=n),placeholder:"Выберите область",style:{width:"100%"}},{default:t(()=>[(r(!0),M(H,null,Q(I.value,n=>(r(),C(ae,{key:n.code,label:n.name,value:n.code},{default:t(()=>[v("span",null,k(n.name),1),v("span",Tt,k(n.code),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])),[[ye,D.value]])]),_:1}),a(xe,{title:"Убедитесь, что у участника загружены и обработаны отчёты с метриками",type:"info",closable:!1,"show-icon":""}),E.value.length===0?(r(),C(xe,{key:0,title:"У участника нет загруженных отчётов",type:"warning",closable:!1,"show-icon":"",style:{"margin-top":"12px"}})):O("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(ve,{modelValue:X.value,"onUpdate:modelValue":e[9]||(e[9]=n=>X.value=n),title:"Метрики отчёта",width:"90%",top:"5vh"},{default:t(()=>[J.value?(r(),C(kt,{key:0,"report-id":J.value,onMetricsUpdated:Ue},null,8,["report-id"])):O("",!0)]),_:1},8,["modelValue"])])),[[ye,T.value]])]),_:1})}}},Jt=he(Ft,[["__scopeId","data-v-525136ef"]]);export{Jt as default};
