import{A as C}from"./AppLayout-DfwcIS6-.js";import{G as y,a1 as D,m as v,z as S,E as g,q as _,w as t,r as d,A as V,o as m,a as u,d as o,B,M as h,u as f,f as w}from"./index-DqXGjsgl.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={async getPendingUsers(){return(await y.get("/admin/pending-users")).data},async approveUser(s){return(await y.post(`/admin/approve/${s}`)).data}},E=D("admin",()=>{const s=v([]),e=v(!1),n=v(null);async function l(){e.value=!0,n.value=null;try{const a=await U.getPendingUsers();return s.value=a,a}catch(a){throw n.value=a.response?.data?.detail||"Ошибка загрузки пользователей",a}finally{e.value=!1}}async function r(a){e.value=!0,n.value=null;try{const i=await U.approveUser(a);return s.value=s.value.filter(c=>c.id!==a),i}catch(i){throw n.value=i.response?.data?.detail||"Ошибка одобрения пользователя",i}finally{e.value=!1}}return{pendingUsers:s,loading:e,error:n,fetchPendingUsers:l,approveUser:r}}),M={class:"admin-users-view"},N={class:"actions-group"},$={__name:"AdminUsersView",setup(s){const e=E(),n=async l=>{try{await e.approveUser(l.id),g.success(`Пользователь ${l.email} одобрен`)}catch{g.error(e.error||"Ошибка одобрения пользователя")}};return S(async()=>{try{await e.fetchPendingUsers()}catch{g.error("Ошибка загрузки пользователей")}}),(l,r)=>{const a=d("el-card"),i=d("el-empty"),c=d("el-table-column"),b=d("el-tag"),A=d("el-button"),k=d("el-table"),x=V("loading");return m(),_(C,null,{default:t(()=>[u("div",M,[o(a,{class:"header-card"},{default:t(()=>[...r[0]||(r[0]=[u("h1",null,"Управление пользователями",-1),u("p",null,"Одобрение новых пользователей системы",-1)])]),_:1}),B((m(),_(a,{class:"users-card"},{default:t(()=>[u("h3",null,"Ожидают одобрения ("+h(f(e).pendingUsers.length)+")",1),f(e).pendingUsers.length===0?(m(),_(i,{key:0,description:"Нет пользователей, ожидающих одобрения"})):(m(),_(k,{key:1,data:f(e).pendingUsers,stripe:""},{default:t(()=>[o(c,{prop:"email",label:"Email","min-width":"250"}),o(c,{label:"Статус",width:"120"},{default:t(({row:p})=>[o(b,{type:"warning"},{default:t(()=>[w(h(p.status),1)]),_:2},1024)]),_:1}),o(c,{prop:"created_at",label:"Дата регистрации",width:"180"},{default:t(({row:p})=>[w(h(new Date(p.created_at).toLocaleDateString("ru-RU")),1)]),_:1}),o(c,{label:"Действия",width:"150",fixed:"right"},{default:t(({row:p})=>[u("div",N,[o(A,{type:"success",size:"small",onClick:z=>n(p)},{default:t(()=>[...r[1]||(r[1]=[w(" Одобрить ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"]))]),_:1})),[[x,f(e).loading]])])]),_:1})}}},R=P($,[["__scopeId","data-v-ac591da7"]]);export{R as default};
