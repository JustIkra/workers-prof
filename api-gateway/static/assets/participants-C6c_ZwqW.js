import{x as i,B as g,r as u}from"./index-Doc1gm_3.js";const c={async create(e){return(await i.post("/participants",e)).data},async search(e={}){return(await i.get("/participants",{params:e})).data},async getById(e){return(await i.get(`/participants/${e}`)).data},async update(e,n){return(await i.put(`/participants/${e}`,n)).data},async delete(e){return(await i.delete(`/participants/${e}`)).data}},x=g("participants",()=>{const e=u([]),n=u(null),r=u(!1),s=u(null),o=u({total:0,page:1,size:20,totalPages:0});async function d(t={}){r.value=!0,s.value=null;try{const a=await c.search(t);return e.value=a.items,o.value={total:a.total,page:a.page,size:a.size,totalPages:Math.ceil(a.total/a.size)},a}catch(a){throw s.value=a.response?.data?.detail||"Ошибка загрузки участников",a}finally{r.value=!1}}async function v(t){r.value=!0,s.value=null;try{const a=await c.getById(t);return n.value=a,a}catch(a){throw s.value=a.response?.data?.detail||"Ошибка загрузки участника",a}finally{r.value=!1}}async function f(t){r.value=!0,s.value=null;try{const a=await c.create(t);return e.value.unshift(a),a}catch(a){throw s.value=a.response?.data?.detail||"Ошибка создания участника",a}finally{r.value=!1}}async function y(t,a){r.value=!0,s.value=null;try{const l=await c.update(t,a),p=e.value.findIndex(w=>w.id===t);return p!==-1&&(e.value[p]=l),n.value?.id===t&&(n.value=l),l}catch(l){throw s.value=l.response?.data?.detail||"Ошибка обновления участника",l}finally{r.value=!1}}async function h(t){r.value=!0,s.value=null;try{await c.delete(t),e.value=e.value.filter(a=>a.id!==t),n.value?.id===t&&(n.value=null)}catch(a){throw s.value=a.response?.data?.detail||"Ошибка удаления участника",a}finally{r.value=!1}}return{participants:e,currentParticipant:n,loading:r,error:s,pagination:o,searchParticipants:d,getParticipant:v,createParticipant:f,updateParticipant:y,deleteParticipant:h}});export{x as u};
