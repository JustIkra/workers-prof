import{A as C}from"./AppLayout-Bl2VZUNY.js";import{G as h,P as D,m as v,z as P,E as g,q as u,w as a,r as d,A as S,o as _,a as m,d as o,B as V,I as w,u as f,f as y}from"./index-B1Cqir3n.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={async getPendingUsers(){return(await h.get("/admin/pending-users")).data},async approveUser(n){return(await h.post(`/admin/approve/${n}`)).data}},E=D("admin",()=>{const n=v([]),e=v(!1),s=v(null);async function l(){e.value=!0,s.value=null;try{const t=await U.getPendingUsers();return n.value=t,t}catch(t){throw s.value=t.response?.data?.detail||"Ошибка загрузки пользователей",t}finally{e.value=!1}}async function r(t){e.value=!0,s.value=null;try{const i=await U.approveUser(t);return n.value=n.value.filter(c=>c.id!==t),i}catch(i){throw s.value=i.response?.data?.detail||"Ошибка одобрения пользователя",i}finally{e.value=!1}}return{pendingUsers:n,loading:e,error:s,fetchPendingUsers:l,approveUser:r}}),N={class:"admin-users-view"},$={__name:"AdminUsersView",setup(n){const e=E(),s=async l=>{try{await e.approveUser(l.id),g.success(`Пользователь ${l.email} одобрен`)}catch{g.error(e.error||"Ошибка одобрения пользователя")}};return P(async()=>{try{await e.fetchPendingUsers()}catch{g.error("Ошибка загрузки пользователей")}}),(l,r)=>{const t=d("el-card"),i=d("el-empty"),c=d("el-table-column"),b=d("el-tag"),A=d("el-button"),k=d("el-table"),x=S("loading");return _(),u(C,null,{default:a(()=>[m("div",N,[o(t,{class:"header-card"},{default:a(()=>[...r[0]||(r[0]=[m("h1",null,"Управление пользователями",-1),m("p",null,"Одобрение новых пользователей системы",-1)])]),_:1}),V((_(),u(t,{class:"users-card"},{default:a(()=>[m("h3",null,"Ожидают одобрения ("+w(f(e).pendingUsers.length)+")",1),f(e).pendingUsers.length===0?(_(),u(i,{key:0,description:"Нет пользователей, ожидающих одобрения"})):(_(),u(k,{key:1,data:f(e).pendingUsers,stripe:""},{default:a(()=>[o(c,{prop:"email",label:"Email","min-width":"250"}),o(c,{label:"Статус",width:"120"},{default:a(({row:p})=>[o(b,{type:"warning"},{default:a(()=>[y(w(p.status),1)]),_:2},1024)]),_:1}),o(c,{prop:"created_at",label:"Дата регистрации",width:"180"},{default:a(({row:p})=>[y(w(new Date(p.created_at).toLocaleDateString("ru-RU")),1)]),_:1}),o(c,{label:"Действия",width:"150",fixed:"right"},{default:a(({row:p})=>[o(A,{type:"success",size:"small",onClick:z=>s(p)},{default:a(()=>[...r[1]||(r[1]=[y(" Одобрить ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]))]),_:1})),[[x,f(e).loading]])])]),_:1})}}},G=B($,[["__scopeId","data-v-98f5e498"]]);export{G as default};
