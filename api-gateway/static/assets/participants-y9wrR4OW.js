import{G as i,P as g,m as u}from"./index-B1Cqir3n.js";const c={async create(e){return(await i.post("/participants",e)).data},async search(e={}){return(await i.get("/participants",{params:e})).data},async getById(e){return(await i.get(`/participants/${e}`)).data},async update(e,n){return(await i.put(`/participants/${e}`,n)).data},async delete(e){return(await i.delete(`/participants/${e}`)).data}},m=g("participants",()=>{const e=u([]),n=u(null),s=u(!1),r=u(null),o=u({total:0,page:1,size:20,totalPages:0});async function d(t={}){s.value=!0,r.value=null;try{const a=await c.search(t);return e.value=a.items,o.value={total:a.total,page:a.page,size:a.size,totalPages:Math.ceil(a.total/a.size)},a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка загрузки участников",a}finally{s.value=!1}}async function v(t){s.value=!0,r.value=null;try{const a=await c.getById(t);return n.value=a,a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка загрузки участника",a}finally{s.value=!1}}async function f(t){s.value=!0,r.value=null;try{const a=await c.create(t);return e.value.unshift(a),a}catch(a){throw r.value=a.response?.data?.detail||"Ошибка создания участника",a}finally{s.value=!1}}async function y(t,a){s.value=!0,r.value=null;try{const l=await c.update(t,a),p=e.value.findIndex(w=>w.id===t);return p!==-1&&(e.value[p]=l),n.value?.id===t&&(n.value=l),l}catch(l){throw r.value=l.response?.data?.detail||"Ошибка обновления участника",l}finally{s.value=!1}}async function h(t){s.value=!0,r.value=null;try{await c.delete(t),e.value=e.value.filter(a=>a.id!==t),n.value?.id===t&&(n.value=null)}catch(a){throw r.value=a.response?.data?.detail||"Ошибка удаления участника",a}finally{s.value=!1}}return{participants:e,currentParticipant:n,loading:s,error:r,pagination:o,searchParticipants:d,getParticipant:v,createParticipant:f,updateParticipant:y,deleteParticipant:h}});export{m as u};
