Актуальный план (после чистки завершённых спринтов)

Цель
- Разблокировать финальные отчёты в UI и довести критический путь E2E до «зелёного».
- Реализовать полноценный Gemini Vision (по умолчанию) → Нормализация пайплайн по правилам `.memory-base`.
- Довести VPN split‑tunnel и наблюдаемость.

Этап A — Final Report UI + History (быстрые фиксы)
1) Загрузка списка отчётов на UI (без заглушек)
2) Кнопки финального отчёта (JSON/HTML) + фиксы клиента API
3) `GET /api/participants/{id}/scores` — история расчётов
4) E2E сценарии 9–10 (просмотр JSON/скачивание HTML)

Этап B — Извлечение и нормализация
1) Gemini Vision: строгий JSON, PII‑safe кропы, валидация схемы/диапазона
2) Нормализация/маппинг в MetricDef по YAML (RU‑формат, валидация)
3) Маркировка неоднозначностей для ручной валидации в UI

Этап C — Рекомендации (AI Text)
1) Генерация рекомендаций: строгая схема JSON, отбрасывание вне диапазона
2) Пул ключей + лимитирование + ретраи (OFFLINE в тестах)
3) Генерация рекомендаций (строгий JSON, ≤5/секцию)

Этап D — VPN и Observability
1) WireGuard entrypoint + split‑tunnel на `generativelanguage.googleapis.com`
2) `/api/vpn/health` — дополнить метриками стабильности при необходимости
3) Логи и метрики: `request_id`, Celery тайминги/ретраи, per‑key счётчики Gemini

Инварианты и тестирование
- OFFLINE режим в `test/ci`; Celery eager; детерминированность времени.
- Покрытие backend ≥60%; критичные модули ≥80%.
- E2E с артефактами на падениях (видео/скриншоты).

Риски/зависимости
- Ключи Gemini и конфиг WireGuard нужны для этапов C/D; без них — заглушки и OFFLINE‑моки.
- Производительность OCR может потребовать нормализации разрешения (см. `extraction-pipeline.md`).
